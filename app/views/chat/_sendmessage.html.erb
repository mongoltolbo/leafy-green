<html>
<head>
    <title>Chat Client</title>
<style type="text/css" media="screen">
    h1 {
      margin: 1em 0;
    }  
  </style>

  </head>
<body>
<script src="http://localhost:8080/application.js" type="text/javascript" charset="utf-8"></script>
<div id="mesg"></div>
<script type="text/javascript" charset="utf-8">
    var jug = new Juggernaut();

    //$("#mesg").append($("<li/>").append("Subscribing to friends"));
   jug.subscribe("/chats/friends", function(data){
		var li = $("<li/>");
		li.text(data);
		$("#mesg").append(li);
	}); 
	
	/* $.ajaxSetup({ 
	  'beforeSend': function(xhr) {xhr.setRequestHeader("Accept", "text/javascript")}
	}); */
	
	$.fn.submitWithAjax = function() {
	  this.submit(function() {
	    $.post(this.action, $(this).serialize(), null, "script");
	    return false;
	  })
	  return this;
	};
	
	$(document).ready(function() {
	  $("#chat_window").submitWithAjax();
	});

</script>

<%= form_tag('/messages/send', :id => 'chat_window', :remote => true) do %>

Please select your ChatRoom<br />

<div id="channelIdsWithRadio">
<% Channel.all.each do |channel| %>
 
   <%= radio_button_tag 'channel_id', channel.name , false , :onchange => "getMessages2('#{channel.name}', '#{channel.name}');"%>
   <%= label_tag(channel.name) %>
<% end %>
</div>

<%= text_field_tag 'msg_body', '', :size => 50 %>
<%= hidden_field_tag 'sender', current_identity1.name%>
<%= submit_tag 'Send Message' %>
<% end %>

<div id="messages2">

</div>
<body>
</html>
