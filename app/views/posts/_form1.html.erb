

<div id="postMsgBox"></div>


<%= form_for post, :html => {:multipart => true , :onsubmit => "postsFormSubmit(this);return false;"}  do |f| %>
  <% if post.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% post.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :content %><br />
    <%= f.text_area :content , :rows=>10, :cols =>27 %>
  </div>
  <div class="field">
    <%= f.file_field :image %> 
    <input type="hidden" name="post[id]" id="post_id" value=""/>
    <input type="hidden" name="image_url" value="" id="image_url"/>
    <input type="hidden" name="method_type" value="post" id="method_type"/>
  </div>
  
   <p>
    <%= f.label :remote_image_url, "or article URL" %><br />
    <%= f.text_field :remote_image_url , :onblur => "populatePostContent(this.value)"%>
  </p>
  
  
  <div class="field">
    <select name="category_id">
    	<% Category.all.each do |category| %>
        <li class="post_category_option">
          <option value="<%= category.id %>"><%= category.name.humanize %></option>
        </li>
      <% end %>
    </select>
  </div>
  <div class="field">
    <%= f.label :visible %><br />
    <%= f.check_box :visible %>
  </div>
  <%= hidden_field_tag(:user_id, session[:user_id]) %>
  <%= hidden_field_tag(:hiddenld) %>

  <div class="actions">
    <%= f.submit "postcreate", :remote => true %>
  </div>
  <script>
  $(function(){
    $('#postform input[name=commit]').bind('click', function(){
      console.log('Caught it!');
      //$("#chat_window").submitWithAjax();
      $('#postform').dialog( "close" );
    });
  });
  </script>
<% end %>

